<h3 class="page-title">Build / Serve</h3>
<div class="page-subheader mdw-font-title-medium">Serve application from Expressjs or build a single page app</div>

<section style="margin-top: 48px;">
  <mdw-card id="build">
    <div class="mdw-card-content">
      <div class="mdw-headline">Build single page app</div>
      <div class="mdw-supporting-text">No need for webpack or other bundlers. ESbuild is packed in and pre configured.</div>
      <ul>
        <li>Minification</li>
        <li>Sourcemaps</li>
        <li>Dev server</li>
        <li>live relaoding</li>
        <li>Adding hashes to filenames</li>
        <li>Rewriting imports for app.js and app.js to have hashes</li>
        <li>Gziping content</li>
        <li>File copying</li>
      </ul>
    </div>
    
    <pre>
      <code class="language-javascript">
  ${`import build from '@webformula/core/build';

  /**
   * Basic
   * If using 'app/' as root folder then no config needed
   */
  build();
  

  /**
   * Full config options
   */
  build({
    // folder that contains 'app.js' : Default 'app.js'
    basedir: 'app/',

    // folder that contains 'app.js' : Default 'dist/'
    outdir: 'dist/',

    /**
    * Default true
    * Split code using routes for optimal loading
    */
    chunks: true,


    /**
     * true when 'NODE_ENV=production' otherwise defaults to false
     * use 'WEBFORMULA_MINIFY' env var to override
     */
    minify: true,

    /**
    * false when 'NODE_ENV=production' otherwise defaults to true
    * use 'WEBFORMULA_SOURCEMAPS' env var to override
    */
    sourcemaps: false,

    /**
    * true when 'NODE_ENV=production' otherwise defaults to false
    * use 'WEBFORMULA_GZIP' env var to override
    */
    gzip: true,

    devServer: {
      /**
      * false when 'NODE_ENV=production' otherwise defaults to true
      */
      enabled: true,

      /**
      * false when 'NODE_ENV=production' otherwise defaults to true
      * use 'WEBFORMULA_LIVERELOAD' env var to override
      */
      liveReload: true

      port: 3000,
    },

    // supports regex's with wildcards (*, **)
    copyFiles: [
      {
        from: 'app/image.jpg',
        to: 'dist/'
      },
      {
        from: 'app/pages/**/(?!page)*.html',
        to: 'dist/pages'
      },
      {
        from: 'app/code.js',
        to: 'dist/code.js',
        transform({ content, outputFileNames }) {
          // doo work
          return content;
        }
      }
    ],

    // callback before bundle
    onStart: () => {},

    // callback after bundle
    onEnd: () => {}
  });`}
      </code>
    </pre>

    <div class="mdw-card-content" style="margin-top: 12px">
      <div class="mdw-subheader">Run commands</div>
    </div>
    <pre>
      <code class="language-bash">
  ${`# Development run
  node build.js
  
  # Development run with watch to enable livereload
  node --watch-path=./app build.js
  
  # Production run. minifies, gzips, and writes files
  NODE_ENV=production node build.js`}
      </code>
    </pre>
  </mdw-card>
</section>

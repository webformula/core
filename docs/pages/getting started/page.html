<h3 class="page-title">Getting started</h3>
<div class="page-subheader mdw-font-title-medium">Build a basic web application</div>

<h6 class="page-secondary-header">Links</h6>
<ul class="links">
  <li><a href="#install">Install</a></li>
  <li><a href="#indexhtml">index.html</a></li>
  <li><a href="#appjs">app.js</a></li>
  <li><a href="#appcss">app.css</a></li>
  <li><a href="#page">Page</a></li>
  <li><a href="#server">Server side</a></li>
  <li><a href="#spa">spa</a></li>
</ul>

<section style="margin-top: 48px;">
  <mdw-card id="install">
    <div class="mdw-card-content">
      <div class="mdw-headline">Install</div>
    </div>

    <div class="mdw-card-content">
      <div class="mdw-subheader">NPM</div>
    </div>
    <pre>
      <code class="language-bash">
  ${`npm install @webformula/core`}
      </code>
    </pre>
  </mdw-card>


  <mdw-card id="indexhtml">
    <div class="mdw-card-content">
      <div class="mdw-headline">index.html</div>
    </div>
  
    <pre>
      <code class="language-html">
  ${page.escape(`<!doctype html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="Cache-Control" content="no-store" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
      <title></title>
      <!--
        load js and css
        app.js is required and app.css is optional
      -->
      <link href="app.css" rel="stylesheet">
      <script src="app.js" type="module"></script>
    </head>
    
    <body>
      <!-- page template render into this element -->
      <page-content></page-content>
    </body>
  </html>`)}
      </code>
    </pre>
  </mdw-card>


  <mdw-card id="appjs">
    <div class="mdw-card-content">
      <div class="mdw-headline">Main application file</div>
      <div class="mdw-subheader">app.js</div>
      <div class="mdw-supporting-text">Required: Automatically uses app.js as entry file for bundling</div>
    </div>

    <pre>
      <code class="language-javascript">
  ${`import { routes } from '@webformula/core';
  
  import home from './pages/home/page.js';
  import one from './pages/one/page.js';
  import notFound from './pages/notfound/page.js';
  
  routes([
    { path: '/', page: home },
    { path: '/one', page: one },
    { path: '/notfound', page: notFound, notFound: true }
  ]);`}
      </code>
    </pre>
  </mdw-card>

  <mdw-card id="appcss">
    <div class="mdw-card-content">
      <div class="mdw-headline">Main application Styles</div>
      <div class="mdw-subheader">app.css</div>
      <div class="mdw-supporting-text">Optional: Will bundle and minify into a single file</div>
    </div>
  
    <pre>
      <code class="language-javascript">
  ${`@import url('./other.css');

  body {
    background-color: white;
  }`}
      </code>
    </pre>
  </mdw-card>


  <mdw-card id="page">
    <div class="mdw-card-content">
      <div class="mdw-headline">Page</div>
      <div class="mdw-subheader">page.js and page.html</div>
    </div>
  
    <pre>
      <code class="language-javascript">
  ${`import { Page } from '@webformula/core';
  import html from './page.html'; // automatically bundles
  
  export default class extends Page {
    static title = 'Page'; // html page title
    static html = html; // hook up imported html. Supports template literals (${this.someVar})

    someVar = 'Some var';
    clickIt_bound = this.clickIt.bind(this);
    userInput;
    
    
    constructor() {
      super();
    }
    
    connectedCallback() {
      // called on element hookup to dome. May not be rendered yet
    
      this.userInput = 'some user input';
      console.log(this.urlParameters); // { id: 'value' }
      console.log(this.searchParameters); // { id: 'value' }
    }
    
    disconnectedCallback() {
      // called on element removal
    }
    
    // not called on initial render
    beforeRender() {
      // Do work before render
    }
    
    afterEnder() {
      // Do work after render
      this.querySelector('#event-listener-button').addEventListener('click', this.clickIt_bound);
    }
    
    // look below to how it is invoked on a button
    clickIt() {
      console.log('clicked it!');
    }
    
    // look below to how it is invoked on a button
    changeValueAndRender() {
      this.someVar = 'Re-rendered';
      this.render(); // initial render is automatic
    }
    
    /**
     * If not importing html you can use this template method.
     * Imported html also supports template literals (${this.someVar})
     */
    template() {
      return /*html*/\`${page.escape(`
        <div>Page Content</div>
        <div>\${this.someVar}</div>
        
        <!-- escape html input -->
        <div>\${this.escape(this.userInput)}</div>
        
        <!-- "page" will reference the current page class -->
        <button onclick="page.clickIt()">Click Method</button>
        <button id="event-listener-button">Event listener</button>
        <button onclick="page.changeValueAndRender()">Change value and render</button>
      `)}\`;
    }
  }`}
      </code>
    </pre>
  </mdw-card>


  <mdw-card id="server">
    <div class="mdw-card-content">
      <div class="mdw-headline">Serve app from express</div>
      <div class="mdw-subheader">server.js</div>
      <div class="mdw-supporting-text">coreMiddleware automatically bundles and splits the code for optimal loading</div>
      <a href="/build">Serve details</a>
    </div>
  
    <pre>
      <code class="language-javascript">
  ${`import express from 'express';
  import compression from 'compression';
  import { coreMiddleware } from '@webformula/core/server';
  
  const app = express();
  const port = 3000;
  
  app.use(compression());
  app.use(coreMiddleware('./app'));
  app.use(express.static('./app'));
  
  app.listen(port, () => {
    console.log(\`Example app listening on port \${port}\`);
  });`}
      </code>
    </pre>

    <div class="mdw-card-content" style="margin-top: 12px">
      <div class="mdw-subheader">Run commands</div>
    </div>
    <pre>
      <code class="language-bash">
  ${`# Development run. Includes sourcemaps
  node build.js
  # using nodemon will enable livereload
  nodemon -e js,css,html build.js

  # Production run. minifies, turns off livereload and sourcemaps
  NODE_ENV=production node build.js
  `}
      </code>
    </pre>
  </mdw-card>

  <mdw-card id="spa">
    <div class="mdw-card-content">
      <div class="mdw-headline">Build single page app</div>
      <div class="mdw-subheader">build.js</div>
      <div class="mdw-supporting-text">No need for webpack or other bundlers. ESbuild is packed in and pre configured.</div>
      <a href="/build#spa">Build config</a>
    </div>
    
    <pre>
      <code class="language-javascript">
  ${`import build from '@webformula/core/build';
  
  /**
   * runs dev server by default on port 3000 with livereload
   * basedir defaults to 'app/'
   */
  build({ basedir: 'app/' });`}
      </code>
    </pre>

    <div class="mdw-card-content" style="margin-top: 12px">
      <div class="mdw-subheader">Run commands</div>
    </div>
    <pre>
      <code class="language-bash">
  ${`# Development run. Includes sourcemaps and livereload
  node build.js

  # Production run. minifies, gzips, and writes files
  NODE_ENV=production node build.js
  `}
      </code>
    </pre>
  </mdw-card>
</section>
